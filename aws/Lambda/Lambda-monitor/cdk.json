{
  "app": "go mod download && bash build.sh && go run aws-env-monitor.go",
  "watch": {
    "include": [
      "**"
    ],
    "exclude": [
      "README.md",
      "cdk*.json",
      "go.mod",
      "go.sum",
      "**/*test.go"
    ]
  },
  "context": {
    "maintainer": "karl.huang",
    "logLevel": "info",
    "project": "https://gitlab.example.com/devops/sysops/lambda/aws-env-monitor",
    "qa": {
      "noticeEnv": {
        "MentionUsers": "Karl.huang",
        "ParameterStore": "xxxxx-mention-user-ids",
        "Retry": "3",
        "NoticeChatWebhookURL":"https://chat.googleapis.com/v1/spaces/AAAApTWlmQo/messages?key=xxxxx&token=xxx",
        "NoticeChatChannel": "stg-monitor",
        "NoticeLarkWebhookURL":"https://open.larksuite.com/open-apis/bot/v2/hook/xxxxx",
        "NoticeLarkChannel": "Karltest",
        "AlarmChatWebhookURL":"https://chat.googleapis.com/v1/spaces/AAAApTWlmQo/messages?key=xxxxx&token=xxx",
        "AlarmChatChannel": "stg-monitor",
        "AlarmLarkWebhookURL":"https://open.larksuite.com/open-apis/bot/v2/hook/xxxxx",
        "AlarmLarkChannel": "Karltest"
      },
      "s3LifecycleMonitor": {
        "ChatWebhookURL": "https://chat.googleapis.com/v1/spaces/AAAApTWlmQo/messages?key=xxxxx&token=xxx",
        "ChatChannel": "stg-monitor",
        "LarkWebhookURL": "https://open.larksuite.com/open-apis/bot/v2/hook/xxxxx",
        "LarkChannel": "Karltest",
        "MentionUsers": "Karl.huang",
        "ParameterStore": "xxxxx-mention-user-ids",
        "SNSArn": "arn:aws:sns:ap-northeast-1:012345678901:qa_sys_notice_topic",
        "ShowEnableLifecycle": "true",
        "Retry": "3",
        "ShowNoLifecycle": "true",
        "ExcludeBuckets": "cdk-hnb659fds-assets-012345678901-ap-northeast-1"
      },
      "costMonitor": {
        "MentionUsers": "Karl.huang",
        "ParameterStore": "xxxxx-mention-user-ids",
        "ANOMALY_TOTAL_IMPACT_ABSOLUTE": "20",
        "ANOMALY_TOTAL_IMPACT_PERCENTAGE": "200",
        "Retry": "3",
        "ChatWebhookURL": "https://chat.googleapis.com/v1/spaces/AAAApTWlmQo/messages?key=xxxxx&token=xxx",
        "ChatChannel": "stg-monitor",
        "LarkWebhookURL": "https://open.larksuite.com/open-apis/bot/v2/hook/xxxxx",
        "LarkChannel": "Karltest"
      },
      "computeOptimizer": {
        "MentionUsers": "Karl.huang",
        "ParameterStore": "xxxxx-mention-user-ids",
        "Retry": "3",
        "ExcludeInstances": "",
        "ChatWebhookURL": "https://chat.googleapis.com/v1/spaces/AAAApTWlmQo/messages?key=xxxxx&token=xxx",
        "ChatChannel": "stg-monitor",
        "LarkWebhookURL": "https://open.larksuite.com/open-apis/bot/v2/hook/xxxxx",
        "LarkChannel": "Karltest",
        "Notice": "false"
      },
      "healthCheck": {
        "WebhookURL": "https://chat.googleapis.com/v1/spaces/AAAApTWlmQo/messages?key=xxxxx&token=xxx",
        "MentionUsers": "Karl.huang",
        "ParameterStore": "xxxxx-mention-user-ids"
      },
      "operationMonitor": {
        "WorkTime": "9:00 - 19:00",
        "MentionUsers": "Karl.huang",
        "ParameterStore": "xxxxx-mention-user-ids",
        "Retry": "3",
        "ChatWebhookURL": "https://chat.googleapis.com/v1/spaces/AAAApTWlmQo/messages?key=xxxxx&token=xxx",
        "ChatChannel": "stg-monitor",
        "LarkWebhookURL": "https://open.larksuite.com/open-apis/bot/v2/hook/xxxxx",
        "LarkChannel": "Karltest",
        "TargetLogGroup": "aws-cloudtrail-logs-012345678901-25a91295",
        "ExcludeUserEvents": "",
        "ExcludeEvents": "DeleteChangeSet,CreateChangeSet,StartQuery,StopQuery,CheckMfa",
        "ExcludeUsers": "zadig,qa_deploy",
        "MentionEvents": "SecurityGroup"
      },
      "ec2StatusMonitor": {
        "MentionUsers": "Karl.huang",
        "ParameterStore": "xxxxx-mention-user-ids",
        "StatusCheckFailedInstanceAlarmName": "EC2InstanceStatusCheck_{INSTANCE_NAME}_{INSTANCE_ID}",
        "StatusCheckFailedSystemAlarmName": "EC2SystemStatusCheck_{INSTANCE_NAME}_{INSTANCE_ID}",
        "Retry": "3",
        "Account": "012345678901",
        "Region": "ap-northeast-1",
        "VPC":"vpc-050d2a8c799afffdd",
        "SubnetA":"subnet-0fe5b1838d42beba2",
        "SubnetC":"subnet-03fe5e8260d9f3c83",
        "SecurityGroupID": "sg-09e14dc0516e0bc9c",
        "TriggerTag":"xxxxx-monitor=on",
        "MonitorChatWebhookURL": "https://chat.googleapis.com/v1/spaces/AAAApTWlmQo/messages?key=xxxxx&token=xxx",
        "MonitorChatChannel": "stg-monitor",
        "MonitorLarkWebhookURL": "https://open.larksuite.com/open-apis/bot/v2/hook/xxxxx",
        "MonitorLarkChannel": "Karltest",
        "AlertManagerURL": "http://alertmanager.internal.example.com:9093/api/v2/alerts",
        "xxxxxType":"ops",
        "AlertDisableAndEnableAlarm": "False"
      },
      "rdsMonitor": {
        "MentionUsers": "Karl.huang",
        "ParameterStore": "xxxxx-mention-user-ids",
        "Retry": "3",
        "MonitorChatWebhookURL": "https://chat.googleapis.com/v1/spaces/AAAApTWlmQo/messages?key=xxxxx&token=xxx",
        "MonitorChatChannel": "stg-monitor",
        "MonitorLarkWebhookURL": "https://open.larksuite.com/open-apis/bot/v2/hook/xxxxx",
        "MonitorLarkChannel": "Karltest",
        "SNSArn": "arn:aws:sns:ap-northeast-1:012345678901:qa_sys_notice_topic"
      }
    },
    "prod": {
      "operationMonitor": {
        "WorkTime": "9:00 - 19:00",
        "MentionUsers": "Karl.huang",
        "ParameterStore": "xxxxx-mention-user-ids",
        "Retry": "3",
        "ChatWebhookURL": "https://chat.googleapis.com/v1/spaces/AAAACfyIbYE/messages?key=xxxxx&token=xxxx",
        "ChatChannel": "prod-monitor-ops-notification",
        "LarkWebhookURL": "https://open.larksuite.com/open-apis/bot/v2/hook/xxxxxx",
        "LarkChannel": "prod-monitor-ops-notification",
        "TargetLogGroup": "prod-cloudtrail-logs",
        "ExcludeUserEvents": "ops_release:PutObject",
        "ExcludeEvents": "DriverExecute,GetAutocompletionResource,GetAutocompletionMetadata,PutTab,DeleteChangeSet,StartQuery,StopQuery,CreateChangeSet,CheckMfa,ResumeSession",
        "ExcludeUsers": "",
        "MentionEvents": "SecurityGroup,Instance,Stop,Delete"
      },
      "noticeEnv": {
        "MentionUsers": "Karl.huang",
        "ParameterStore": "xxxxx-mention-user-ids",
        "Retry": "3",
        "NoticeChatWebhookURL":"https://chat.googleapis.com/v1/spaces/AAAACfyIbYE/messages?key=xxxxx&token=xxxx",
        "NoticeChatChannel": "prod-monitor-ops-notification",
        "NoticeLarkWebhookURL":"https://open.larksuite.com/open-apis/bot/v2/hook/xxxxxx",
        "NoticeLarkChannel": "prod-monitor-ops-notification",
        "AlarmChatWebhookURL":"https://chat.googleapis.com/v1/spaces/AAAACLdUKK0/messages?key=xxxxx&token=xxxxxx",
        "AlarmChatChannel": "prod-monitor-alarm",
        "AlarmLarkWebhookURL":"https://open.larksuite.com/open-apis/bot/v2/hook/xxxxx",
        "AlarmLarkChannel": "prod-monitor-alarm"
      },
      "costMonitor": {
        "MentionUsers": "Karl.huang",
        "ParameterStore": "xxxxx-mention-user-ids",
        "ANOMALY_TOTAL_IMPACT_ABSOLUTE": "100",
        "ANOMALY_TOTAL_IMPACT_PERCENTAGE": "10",
        "Retry": "3",
        "ChatWebhookURL": "https://chat.googleapis.com/v1/spaces/AAAACfyIbYE/messages?key=xxxxx&token=xxxx",
        "ChatChannel": "prod-monitor-ops-notification",
        "LarkWebhookURL": "https://open.larksuite.com/open-apis/bot/v2/hook/xxxxxx",
        "LarkChannel": "prod-monitor-ops-notification"
      },
      "computeOptimizer": {
        "MentionUsers": "Karl.huang",
        "ParameterStore": "xxxxx-mention-user-ids",
        "Retry": "3",
        "ExcludeInstances": "",
        "ChatWebhookURL": "https://chat.googleapis.com/v1/spaces/AAAACfyIbYE/messages?key=xxxxx&token=xxxx",
        "ChatChannel": "prod-monitor-ops-notification",
        "LarkWebhookURL": "https://open.larksuite.com/open-apis/bot/v2/hook/xxxxxx",
        "LarkChannel": "prod-monitor-ops-notification",
        "Notice": "false"
      },
      "ec2StatusMonitor": {
        "MentionUsers": "Karl.huang",
        "ParameterStore": "xxxxx-mention-user-ids",
        "StatusCheckFailedInstanceAlarmName": "EC2InstanceStatusCheck_{INSTANCE_NAME}_{INSTANCE_ID}",
        "StatusCheckFailedSystemAlarmName": "EC2SystemStatusCheck_{INSTANCE_NAME}_{INSTANCE_ID}",
        "Retry": "3",
        "Account": "012345678901",
        "Region": "ap-northeast-1",
        "VPC":"vpc-0d3136ef8aa4c0ed6",
        "SubnetA":"subnet-0f4b295e50837d4f5",
        "SubnetC":"subnet-0a11fdd693754c78e",
        "SecurityGroupID": "sg-025bdead0d2c9c998",
        "TriggerTag":"xxxxx-monitor=on",
        "MonitorChatWebhookURL": "https://chat.googleapis.com/v1/spaces/AAAACfyIbYE/messages?key=xxxxx&token=xxxx",
        "MonitorChatChannel": "prod-monitor-ops-notification",
        "MonitorLarkWebhookURL": "https://open.larksuite.com/open-apis/bot/v2/hook/xxxxxx",
        "MonitorLarkChannel": "prod-monitor-ops-notification",
        "AlertManagerURL": "http://alertmanager.internal.example.com:9093/api/v2/alerts",
        "xxxxxType":"ops",
        "AlertDisableAndEnableAlarm": "True"
      },
      "rdsMonitor": {
        "MentionUsers": "Karl.huang",
        "ParameterStore": "xxxxx-mention-user-ids",
        "Retry": "6",
        "MonitorChatWebhookURL": "https://chat.googleapis.com/v1/spaces/AAAACfyIbYE/messages?key=xxxxx&token=xxxx",
        "MonitorChatChannel": "prod-monitor-ops-notification",
        "MonitorLarkWebhookURL": "https://open.larksuite.com/open-apis/bot/v2/hook/xxxxxx",
        "MonitorLarkChannel": "prod-monitor-ops-notification",
        "SNSArn": "arn:aws:sns:ap-northeast-1:012345678901:prod_sys_notice_topic"
      },
      "s3LifecycleMonitor": {
        "ChatWebhookURL": "https://chat.googleapis.com/v1/spaces/AAAACfyIbYE/messages?key=xxxxx&token=xxxx",
        "ChatChannel": "prod-monitor-ops-notification",
        "LarkWebhookURL": "https://open.larksuite.com/open-apis/bot/v2/hook/xxxxxx",
        "LarkChannel": "prod-monitor-ops-notification",
        "MentionUsers": "Karl.huang",
        "ParameterStore": "xxxxx-mention-user-ids",
        "SNSArn": "arn:aws:sns:ap-northeast-1:012345678901:prod_sys_notice_topic",
        "ShowEnableLifecycle": "true",
        "Retry": "3",
        "ShowNoLifecycle": "true",
        "ExcludeBuckets": ""
      }
    },
    "@aws-cdk/aws-lambda:recognizeLayerVersion": true,
    "@aws-cdk/core:checkSecretUsage": true,
    "@aws-cdk/core:target-partitions": [
      "aws",
      "aws-cn"
    ],
    "@aws-cdk-containers/ecs-service-extensions:enableDefaultLogDriver": true,
    "@aws-cdk/aws-ec2:uniqueImdsv2TemplateName": true,
    "@aws-cdk/aws-ecs:arnFormatIncludesClusterName": true,
    "@aws-cdk/aws-iam:minimizePolicies": true,
    "@aws-cdk/core:validateSnapshotRemovalPolicy": true,
    "@aws-cdk/aws-codepipeline:crossAccountKeyAliasStackSafeResourceName": true,
    "@aws-cdk/aws-s3:createDefaultLoggingPolicy": true,
    "@aws-cdk/aws-sns-subscriptions:restrictSqsDescryption": true,
    "@aws-cdk/aws-apigateway:disableCloudWatchRole": true,
    "@aws-cdk/core:enablePartitionLiterals": true,
    "@aws-cdk/aws-events:eventsTargetQueueSameAccount": true,
    "@aws-cdk/aws-iam:standardizedServicePrincipals": true,
    "@aws-cdk/aws-ecs:disableExplicitDeploymentControllerForCircuitBreaker": true,
    "@aws-cdk/aws-iam:importedRoleStackSafeDefaultPolicyName": true,
    "@aws-cdk/aws-s3:serverAccessLogsUseBucketPolicy": true,
    "@aws-cdk/aws-route53-patters:useCertificate": true,
    "@aws-cdk/customresources:installLatestAwsSdkDefault": false,
    "@aws-cdk/aws-rds:databaseProxyUniqueResourceName": true,
    "@aws-cdk/aws-codedeploy:removeAlarmsFromDeploymentGroup": true,
    "@aws-cdk/aws-apigateway:authorizerChangeDeploymentLogicalId": true,
    "@aws-cdk/aws-ec2:launchTemplateDefaultUserData": true,
    "@aws-cdk/aws-secretsmanager:useAttachedSecretResourcePolicyForSecretTargetAttachments": true,
    "@aws-cdk/aws-redshift:columnId": true,
    "@aws-cdk/aws-stepfunctions-tasks:enableEmrServicePolicyV2": true,
    "@aws-cdk/aws-ec2:restrictDefaultSecurityGroup": true,
    "@aws-cdk/aws-apigateway:requestValidatorUniqueId": true,
    "@aws-cdk/aws-kms:aliasNameRef": true,
    "@aws-cdk/core:includePrefixInUniqueNameGeneration": true
  }
}